# DBA1

[](./images/DBA1-logo.jpg)

## Настройка рабочего места

Необходимо наличие **виртуальной машины** версии 6.1 и новее.

Ссылка для скачивания образа виртуальной машины: https://edu.postgrespro.ru/16/DBA1-16.ova

## Установка

Внутри виртуальной машины уже будет архив с PostgreSQL

```bash
cd
tar -xzf postgresql-16.0.tar.gz
cd postgresql-16.0
```

### Конфигурация

Скрипт configure по умолчанию подготавливает сборку и установку исполняемых файлов, библиотек и прочих файлов PostgreSQL в каталог /usr/local/pgsql. Обычно каталог установки доступен для записи только суперпользователю ОС. 

Ниже будет конфигурация с дополнительными флагами, можно установить и без них.

```bash
./configure --prefix=/home/student/pgsql16 --with-pgport=5555
```

- --prefix -**каталог установки**

- --with-pgprort - **порт для PostgreSQL**

### Сборка и установка сервера

#### Сборка сервера

- make - сборка только сервера
- make world - сборка сервера, всех расширений и документации

Установки только сервера будет достаточно для выполнения заданий.

```bash
make
```

#### Установка сервера

- make install - если сборка была **только** сервера
- make install-world - если сборка была вместе с расширениями и документацией

```bash
make install
```

## Настройка переменных окружения

Создаем каталог для данных

```bash
mkdir /home/student/pgsql16/data
```

Создаем переменную для окружения для удобства работы

```bash
export PGDATA=/home/student/pgsql16/data
```

Создаем переменную окружения, в котороую добавим путь ко всем утилитам сервера

```bash
export PATH=/home/student/pgsql16/bin
```

## Инициализация кластера базы данных

```bash
initdb -U postgres -k -D /home/student/pgsql16/data
```
- -U - имя суперпользователя СУБД. Если не указывать этот флаг, то суперпользователем будет назначен student.
- -k - подсчет контрольных сумм для обнаружения поврежденных данных
- -D - каталог для данных. Если установлена переменная PGDATA, то флаг не нужен
